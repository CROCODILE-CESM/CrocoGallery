{"version":3,"kind":"Notebook","sha256":"ac1b23f1bbc42d56df7cdf973bce510fcebc3ae706fe15f424fa81f7bc90c763","slug":"notebooks.features.subset-global","location":"/notebooks/features/subset_global.ipynb","dependencies":[],"frontmatter":{"title":"Add Global Subset Grids","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"CrocoDash","language":"python"},"github":"https://github.com/CROCODILE-CESM/CrocoGallery","numbering":{"title":{"offset":3}},"source_url":"https://github.com/CROCODILE-CESM/CrocoGallery/blob/HEAD/gallery/notebooks/features/subset_global.ipynb","edit_url":"https://github.com/CROCODILE-CESM/CrocoGallery/edit/HEAD/gallery/notebooks/features/subset_global.ipynb","exports":[{"format":"ipynb","filename":"subset_global.ipynb","url":"/CrocoGallery/pr-28/build/subset_global-1a74e2faba99dceb6f2e15d9bf602321.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1.1: Horizontal Grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iExy8xixAh"}],"identifier":"step-1-1-horizontal-grid","label":"Step 1.1: Horizontal Grid","html_id":"step-1-1-horizontal-grid","implicit":true,"key":"u4m7xgKxy6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Extract a subgrid from a global grid using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Bfvzasd0o5"},{"type":"inlineCode","value":"subgrid_from_supergrid","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P9PaFmn62q"},{"type":"text","value":" method:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VB5M2Bvyhd"}],"key":"v0T9gcH8ZP"}],"key":"hGvcGpE2TO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.grid import Grid\n\ngrid = Grid.subgrid_from_supergrid(\n    path = \"<HGRID_TRIMMED>\",  # supergrid\n    llc = (16.0, 192.0),  # (l)ower (l)eft (c)orner coords\n    urc = (27.0, 209.0),  # (u)pper (r)ight (c)orner coords\n    name = \"hawaii_2\"\n)","key":"HL1fYOJmDG"},{"type":"outputs","id":"2W7oZgKlXmth1FKDyJNfS","children":[],"key":"BaAciDATx9"}],"key":"j0qqWjf1yG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1.2: Topography","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rkbjJb3AqV"}],"identifier":"step-1-2-topography","label":"Step 1.2: Topography","html_id":"step-1-2-topography","implicit":true,"key":"DrXjGlMhfL"}],"key":"VKluTg3ygR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.topo import Topo\n\ntopo = Topo(\n    grid = grid,\n    min_depth = 9.5,\n)","key":"yucriK0h8T"},{"type":"outputs","id":"z9evWsUzHMMl_nXqI3umK","children":[],"key":"EUWu2UVhws"}],"key":"g0IPSbUGec"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bathymetry_path='<GEBCO>'\n\ntopo.interpolate_from_file(\n    file_path = bathymetry_path,\n    longitude_coordinate_name=\"lon\",\n    latitude_coordinate_name=\"lat\",\n    vertical_coordinate_name=\"elevation\"\n)","key":"PNzOfjhycC"},{"type":"outputs","id":"fskXrLUJJ-uZtE_zUiE7I","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Begin regridding bathymetry...\n\nOriginal bathymetry size: 6.26 Mb\nRegridded size: 0.70 Mb\nAutomatic regridding may fail if your domain is too big! If this process hangs or crashes,open a terminal with appropriate computational and resources try calling ESMF directly in the input directory None via\n\n`mpirun -np NUMBER_OF_CPUS ESMF_Regrid -s bathymetry_original.nc -d bathymetry_unfinished.nc -m bilinear --src_var depth --dst_var depth --netcdf4 --src_regional --dst_regional`\n\nFor details see https://xesmf.readthedocs.io/en/latest/large_problems_on_HPC.html\n\nAfterwards, run the 'expt.tidy_bathymetry' method to skip the expensive interpolation step, and finishing metadata, encoding and cleanup.\n\n\n\nRegridding successful! Now calling `tidy_bathymetry` method for some finishing touches...\nTidy bathymetry: Reading in regridded bathymetry to fix up metadata...done. Filling in inland lakes and channels... done.\nsetup bathymetry has finished successfully.\n"},"children":[],"key":"xRADmbOqOo"}],"key":"jANjBvoI0k"}],"key":"KBsOMAUY9R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"topo.depth.plot()","key":"rMFGLdWT6D"},{"type":"outputs","id":"aJa_GvwTS1dHbZdCwy4M8","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"562f99b64566d7afcc44c6f034ae37c3","path":"/CrocoGallery/pr-28/build/562f99b64566d7afcc44c6f034ae37c3.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"mQxllYWKut"}],"key":"JuWRXy6bkg"}],"key":"qJfI0GyCCG"}],"key":"Js3WkjfH6H"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Run a coupled sea ice (CICE) & ocean (MOM6) model","url":"/notebooks/features/add-cice","group":"Coupling Tutorials"},"next":{"title":"Use Custom Pre-Generated Grids","url":"/notebooks/features/add-grids","group":"Grid Customization Tutorials"}}},"domain":"http://localhost:3000"}