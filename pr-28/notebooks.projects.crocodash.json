{"version":3,"kind":"Notebook","sha256":"609adeb5de67382dd9ff5510651036155f9f4d1d80f89458c73c844848cd8437","slug":"notebooks.projects.crocodash","location":"/notebooks/projects/CrocoDash.ipynb","dependencies":[],"frontmatter":{"title":"CrocoDash Workshop Project","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"CrocoDash","language":"python"},"github":"https://github.com/CROCODILE-CESM/CrocoGallery","numbering":{"title":{"offset":1}},"source_url":"https://github.com/CROCODILE-CESM/CrocoGallery/blob/HEAD/gallery/notebooks/projects/CrocoDash.ipynb","edit_url":"https://github.com/CROCODILE-CESM/CrocoGallery/edit/HEAD/gallery/notebooks/projects/CrocoDash.ipynb","exports":[{"format":"ipynb","filename":"CrocoDash.ipynb","url":"/CrocoGallery/pr-28/build/CrocoDash-4a438e075b7bdc9b4b305a84ba5217c5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this notebook, the code has the simplest regional ocean model setup possible through CrocoDash. In the comments and descriptions, we’ll provide some of the ways you can add and build on this demo (recreate a specific domain - like GFDL’s NWA12, run with CICE - the sea-ice model in CESM, run with MARBL - the ocean BGC model in CESM, and beyond!)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dfiGQPbB0N"}],"key":"PDg0WjhZEq"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook is designed for new users of CrocoDash and CESM who want to set up a simple regional ocean model. By following the steps, you will learn how to generate a domain, configure a CESM case, prepare ocean forcing data, and run your simulation.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TQanYDSMlE"}],"key":"on7iccUnPR"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"A typical workflow of utilizing CrocoDash consists of four main steps:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TtkbnBiPrD"}],"key":"vXFl39abpl"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generate a regional MOM6 domain.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YnmuZnj1Sf"}],"key":"VOxTmBEBfy"}],"key":"QiSA0CPSaM"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create the CESM case.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"H09D33Ek2N"}],"key":"uJBd670jqj"}],"key":"v1lN2lvSfA"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prepare ocean forcing data.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VIHZBenQZ6"}],"key":"lt95oMzBU0"}],"key":"LopK1qf3ta"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Build and run the case.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rNzfpOhaEe"}],"key":"EMRknmSMYP"}],"key":"zmonzlry8v"}],"key":"oq5aMfA6Zw"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Every specialization of CrocoDash will use this framework.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"O7MCRG2SGR"}],"key":"T8xtzM9koV"}],"key":"ONbXlvDcwy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SECTION 1: Generate a regional MOM6 domain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rPVs2CHwlB"}],"identifier":"section-1-generate-a-regional-mom6-domain","label":"SECTION 1: Generate a regional MOM6 domain","html_id":"section-1-generate-a-regional-mom6-domain","implicit":true,"key":"JcgQQPPGAp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We begin by defining a regional MOM6 domain using CrocoDash. To do so, we first generate a horizontal grid. We then generate the topography by remapping an existing bathymetric dataset to our horizontal grid. Finally, we define a vertical grid.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MBiQoOgfwW"}],"key":"K1L9cZvkdE"}],"key":"HQ2Ld36Mzg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1.1: Horizontal Grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pi11cCX6S4"}],"identifier":"step-1-1-horizontal-grid","label":"Step 1.1: Horizontal Grid","html_id":"step-1-1-horizontal-grid","implicit":true,"key":"JX55YAWTGX"}],"key":"GWUofrXCgb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.grid import Grid\n\ngrid = Grid(\n  resolution = 0.05, # in degrees\n  xstart = 278.0, # min longitude in [0, 360]\n  lenx = 3.0, # longitude extent in degrees\n  ystart = 7.0, # min latitude in [-90, 90]\n  leny = 3.0, # latitude extent in degrees\n  name = \"panama1\",\n)\n\n# Try changing the grid resolution or domain boundaries to model a different region!","key":"W2jwEkJ4Gm"},{"type":"outputs","id":"bWq09rAEJciB8B0Le5QRC","children":[],"key":"hZOnbZW7IB"}],"key":"gS49P8yBpV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above cell is a way to generate a rectangular lat/lon grid through CrocoDash","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iFxfl0mA1Y"}],"key":"VLfiBczhQV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If you’re interested in using an already generated regional grid, you can do that by passing in a supergrid, like in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wnXkZBWXa9"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"this demo","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xVYYkA9vyA"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","key":"XlHi8Lg4PC"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LUMK4mgL22"}],"key":"eqE7g5Ry4C"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"If you’re interested in subsetting an already generated global grid, you can do that by passing in lat/lon args, like in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"w6CjOIIfBa"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/subset_global.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"this demo","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bxa7QIZ0hm"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/subset_global.html","key":"OHRZvpzO6i"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WJUCuOiRrp"}],"key":"Uv66CyZ81D"}],"key":"Caem5K4rQb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1.2: Topography","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H1PBqfJoz0"}],"identifier":"step-1-2-topography","label":"Step 1.2: Topography","html_id":"step-1-2-topography","implicit":true,"key":"UKRb3JwG5n"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The below three cells are a way to generate topography with a given grid using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L3OaRKTw0B"},{"type":"link","url":"https://www.gebco.net/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GEBCO","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xUZrT4AyD8"}],"urlSource":"https://www.gebco.net/","key":"spg7hoh6MG"},{"type":"text","value":" dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sabvcfk3fb"}],"key":"tynMzyyyIi"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"If you’re interested in using a previously generated topography for your grid, you can do that by passing in a topography file, like in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W4vlGUW6w4"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"this demo.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JaEIh3QZCJ"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","key":"ljqm7wQxrb"}],"key":"cOS5dMqgr3"}],"key":"dHcOogdM1l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.topo import Topo\n\ntopo = Topo(\n    grid = grid,\n    min_depth = 9.5, # in meters\n)","key":"yIEPAEa3J9"},{"type":"outputs","id":"mK1pnyHryzthxXr8w2Bk_","children":[],"key":"OSasoBIKBF"}],"key":"NbmtBeetja"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bathymetry_path='<GEBCO>'\n\ntopo.interpolate_from_file(\n    file_path = bathymetry_path,\n    longitude_coordinate_name=\"lon\",\n    latitude_coordinate_name=\"lat\",\n    vertical_coordinate_name=\"elevation\"\n)","key":"bakykSxKMS"},{"type":"outputs","id":"D1RTW1Vw5LPktXsKOdSrG","children":[],"key":"QP5l3coEOo"}],"key":"YxR72baXZL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Validate that the topography looks right!\ntopo.depth.plot()","key":"NwyOha3SBE"},{"type":"outputs","id":"hsOJLGCldMZ5EKNc2kXfM","children":[],"key":"NoVHaig7gO"}],"key":"gr19aqHcmU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Editing the topography","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZawrBRLfII"}],"identifier":"editing-the-topography","label":"Editing the topography","html_id":"editing-the-topography","implicit":true,"key":"TpT6I4OMNE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Regridding topography from GEBCO may result in features we do not necessarily want. The Topo Editor is a tool to edit the bathymetry as wanted. You can do things like erasing basins, opening or closing bays, or adjusting the minimum depth. On JupyterHub, remember we need the ipympl extension, which can be installed as shown on ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Bhki1lq8lQ"},{"type":"link","url":"https://docs.google.com/presentation/d/1ZwM2YKmMumM0kggT9QpgXnizHzCdIaUdO8PBH9TR2ls/edit?slide=id.g38d23f5381c_0_0#slide=id.g38d23f5381c_0_0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"this slide.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aJJxf3rmBn"}],"urlSource":"https://docs.google.com/presentation/d/1ZwM2YKmMumM0kggT9QpgXnizHzCdIaUdO8PBH9TR2ls/edit?slide=id.g38d23f5381c_0_0#slide=id.g38d23f5381c_0_0","key":"ta0wh6enAs"}],"key":"oEcUsmlcKM"}],"key":"ZO6uQ4yOcF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib ipympl\nfrom CrocoDash.topo_editor import TopoEditor\nTopoEditor(topo)","key":"Wv0lgSsO1Z"},{"type":"outputs","id":"XTJeglz40_MDpisweCdgR","children":[],"key":"XUB4IXUUg9"}],"key":"xOrb8KdSVl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1.3: Vertical Grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AlvqglQMFZ"}],"identifier":"step-1-3-vertical-grid","label":"Step 1.3: Vertical Grid","html_id":"step-1-3-vertical-grid","implicit":true,"key":"fV5TrMxhVy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The below cell generates a vertical grid using a hyperbolic function. We can also create a uniform grid instance, or use a previously generated vertical grid, like in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nJ64mMYSfZ"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"this demo.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BuVmbr0mHx"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_grids.html","key":"jRul1tXk84"}],"key":"M8rN4aGEIG"}],"key":"q0I4XfSuXd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.vgrid import VGrid\n\nvgrid  = VGrid.hyperbolic(\n    nk = 75, # number of vertical levels\n    depth = topo.max_depth,\n    ratio=20.0 # target ratio of top to bottom layer thicknesses\n)","key":"VZ1Zs6bYZK"},{"type":"outputs","id":"DMT8a8BRjVGPEVZY1B9fa","children":[],"key":"nL7CTWxNkW"}],"key":"phxZzxgVvl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nplt.close()\n# Create the plot\nfor depth in vgrid.z:\n    plt.axhline(y=depth, linestyle='-')  # Horizontal lines\n\nplt.ylim(max(vgrid.z) + 10, min(vgrid.z) - 10)  # Invert y-axis so deeper values go down\nplt.ylabel(\"Depth\")\nplt.title(\"Vertical Grid\")\nplt.show()","key":"oT4eyLkBlT"},{"type":"outputs","id":"YLvTApT9XgQWekvw2hf5V","children":[],"key":"NnXfUblhBc"}],"key":"eWbveAfFXB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SECTION 2: Create the CESM case","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aZHRCtcxPZ"}],"identifier":"section-2-create-the-cesm-case","label":"SECTION 2: Create the CESM case","html_id":"section-2-create-the-cesm-case","implicit":true,"key":"svQ11gxKY9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After generating the MOM6 domain, the next step is to create a CESM case using CrocoDash. This process is straightforward and involves instantiating the CrocoDash Case object. The Case object requires the following inputs:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZrzhXINRz6"}],"key":"ZP0eRUTQr0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CESM Source Directory: A local path to a compatible CESM source copy.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tZ8ZvbqIpt"}],"key":"OP1mZrds4S"}],"key":"E4QNI5pwe1"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Case Name: A unique name for the CESM case.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZnvmoCwHSz"}],"key":"n7oiOXoebg"}],"key":"pLwkcCc8f6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Input Directory: The directory where all necessary input files will be written.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"If5Ru389pn"}],"key":"Deutl4SFhp"}],"key":"AliXuLX6hK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"MOM6 Domain Objects: The horizontal grid, topography, and vertical grid created in the previous section.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"inlrh3drCA"}],"key":"fG9a589cXd"}],"key":"diQ4nxoHcy"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Project ID: (Optional) A project ID, if required by the machine.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TpMjVipJUA"}],"key":"IQhwgsOpWn"}],"key":"GkZZE3K0Dm"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compset: The set of models to be used in the Case. Standalone Ocean, Ocean-BGC, Ocean-Seaice, Ocean-Runoff, etc...","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"U2lVKFVsyt"}],"key":"CZh8cGNZ9f"}],"key":"I5vbMShy4F"}],"key":"maTR9U3VQy"}],"key":"HzySe1bwog"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2.1: Specify case name and directories:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KQJdsmN6IY"}],"identifier":"step-2-1-specify-case-name-and-directories","label":"Step 2.1: Specify case name and directories:","html_id":"step-2-1-specify-case-name-and-directories","implicit":true,"key":"XNwfslwiIf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Begin by specifying the case name and the necessary directory paths. Ensure the CESM root directory points to your own local copy of CESM. Below is an example setup:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fG9lJKz4Td"}],"key":"IqrF5Lj81y"}],"key":"jITlEY4M5X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path","key":"UySJ3V2lsX"},{"type":"outputs","id":"zDZgOGcNuE5BiisRXpiLW","children":[],"key":"nstgFIEswg"}],"key":"nr4vM9mcso"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# CESM case (experiment) name\ncasename = \"<casename>\"\n\n# CESM source root (Update this path accordingly!!!)\ncesmroot =\"/glade/work/<YOURUSERNAME>/CROCESM\"\n\n# Place where all your input files go \ninputdir = Path(\"/glade/work/<YOURUSERNAME>/crocodile_2025\") / \"croc_input\" / casename\n    \n# CESM case directory\ncaseroot = Path(\"/glade/work/<YOURUSERNAME>/crocodile_2025\") / \"croc_cases\" / casename","key":"Jv1iccFOx3"},{"type":"outputs","id":"n0wkEp7jUl5qkd8yge4Z3","children":[],"key":"OlYT39BdDu"}],"key":"kTeLxOdm8M"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2.2: Create the Case","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xa95COIAgf"}],"identifier":"step-2-2-create-the-case","label":"Step 2.2: Create the Case","html_id":"step-2-2-create-the-case","implicit":true,"key":"FRqCiCdDxh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To create the CESM case, instantiate the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rnJs0IqPnM"},{"type":"inlineCode","value":"Case","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CdipFoQLeQ"},{"type":"text","value":" object as shown below. This will automatically set up the CESM case based on the provided inputs: The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bMkHDIkdIB"},{"type":"inlineCode","value":"cesmroot","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uUupUlH9oP"},{"type":"text","value":" argument specifies the path to your local CESM source directory.\nThe ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tVPLAPkwzo"},{"type":"inlineCode","value":"caseroot","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pGlQNmFp4j"},{"type":"text","value":" argument defines the directory where the case will be created. CrocoDash will handle all necessary namelist modifications and XML changes to align with the MOM6 domain objects generated earlier.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cC8ezfXblI"}],"key":"UGEDKX4sr4"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This is where we can change the model setup to what we want:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fMshCUr3a3"}],"key":"tDLNvE6D4p"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Interested in BGC? Check out ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PgUjzRSr7h"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_bgc.html","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"the demo for how to modify this notebook for BGC.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ALmtvXBKvw"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_bgc.html","key":"UnUxUp09zj"}],"key":"V9lzH6dCqS"}],"key":"M57YyhRmYf"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Interested in CICE? Check out ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"a7JwJmQS0X"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_cice.html","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"the demo for how to modify this notebook for CICE.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eftkA253S9"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_cice.html","key":"aLFRA28zm4"}],"key":"pnzSMWub8N"}],"key":"WS4YVNe2hV"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Interested in Data Runoff from GLOFAS (or JRA)? Check out ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Y4g6ObuMNA"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_rof.html","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"the demo for how to modify this notebook for Data Runoff.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qw1mW92s3t"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_rof.html","key":"UIhv6iqoUq"}],"key":"M7xZUNwkld"}],"key":"VaebfVfsYe"}],"key":"amWUfOFg8N"}],"key":"Swu9mnvs3p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from CrocoDash.case import Case\n\ncase = Case(\n    cesmroot = cesmroot,\n    caseroot = caseroot,\n    inputdir = inputdir,\n    ocn_grid = grid,\n    ocn_vgrid = vgrid,\n    ocn_topo = topo,\n    project = 'CESM0030',\n    override = True,\n    machine = \"derecho\",\n    compset = \"CR_JRA\" # Change this as necessary to include whatever models you want. Use the entire compset: BGC? change MOM6 to MOM6%MARBL-BIO, CICE? Change SICE to CICE, GLOFAS Runoff? Change SROF to DROF%GLOFAS\n)","key":"JOnmjUJ4BC"},{"type":"outputs","id":"0cnUxi-zCwazED8An9_fB","children":[],"key":"A71ExpgX79"}],"key":"PCXXGHSLou"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section 3: Prepare ocean forcing data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xRKoGQqwGI"}],"identifier":"section-3-prepare-ocean-forcing-data","label":"Section 3: Prepare ocean forcing data","html_id":"section-3-prepare-ocean-forcing-data","implicit":true,"key":"s6IuetiPJC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We need to cut out our ocean forcing. The package expects an initial condition and one time-dependent segment per non-land boundary.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lG9gYBf9Aw"}],"key":"GqiiwaVY8N"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this notebook, we are forcing with the Copernicus Marine “Glorys” reanalysis dataset.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CQP1NXv8Z4"}],"key":"CjhjTcDqV6"},{"type":"heading","depth":3,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Step 3.1 Configure Initial Conditions and Forcings","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xAmu9n8Xp3"}],"identifier":"step-3-1-configure-initial-conditions-and-forcings","label":"Step 3.1 Configure Initial Conditions and Forcings","html_id":"step-3-1-configure-initial-conditions-and-forcings","implicit":true,"key":"KSOiCw96t1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Interested in adding tides? Check out ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QNf27XppnL"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_tides.html","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"the demo.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"apV6OA8O6K"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_tides.html","key":"reXne3jYXa"}],"key":"wly7eeYnnA"}],"key":"bfCPX3YGAl"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Interested in adding chlorophyll? Check out ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"poBC7VUVat"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_chl.html","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"the demo.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"jqKS4UO9A5"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_chl.html","key":"Xg8WnkCOpW"}],"key":"AE38CUm0iB"}],"key":"Al0DbVp8LM"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is the GLORYS data access function not working? Check out alternative options in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qbKWkCGMdi"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_data_products.html","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"this demo.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"eTEfxPyUmO"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_data_products.html","key":"NkPBiQtxQr"}],"key":"TbSUWH2wxF"}],"key":"YNB4e08LoQ"}],"key":"u8XKlbXHAN"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Configure Forcings MUST be modified if BGC or Data Runoff are part of the compset (and will throw an error). Check out the demos to see the changes required: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cVKtGlQYrP"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_bgc.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"BGC Demo","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tr0beQKV30"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_bgc.html","key":"ukKzLRF40u"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Lu0VrBsUDg"},{"type":"link","url":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_rof.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"DROF Demo","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"V8ZC09GeKy"}],"urlSource":"https://crocodile-cesm.github.io/CrocoGallery/notebooks/features/add_rof.html","key":"X3sEHu67zV"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Pw7XH0K2oh"}],"key":"gQAMSCraFj"}],"key":"DY0sxDLm8c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"case.configure_forcings(\n    date_range = [\"2020-01-01 00:00:00\", \"2020-01-06 00:00:00\"],\n    product_name = \"GLORYS\",\n    function_name=\"get_glorys_data_from_rda\"\n)","key":"D4xG544JAB"},{"type":"outputs","id":"BwukxwNOk_XSmKNa5hea9","children":[],"key":"wDtJr9Hwsu"}],"key":"Q6J1Ho4qz1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3.3: Process forcing data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4dQrtM5zY"}],"identifier":"step-3-3-process-forcing-data","label":"Step 3.3: Process forcing data","html_id":"step-3-3-process-forcing-data","implicit":true,"key":"C0jydp7qjx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this final step, we call the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fVqAV8nrEY"},{"type":"inlineCode","value":"process_forcings","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ELrgvBAV5b"},{"type":"text","value":" method of CrocoDash to cut out and interpolate the initial condition as well as all boundaries. CrocoDash also updates MOM6 runtime parameters and CESM xml variables accordingly.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CYpGFtcTa3"}],"key":"ARLG8sF4Ct"}],"key":"G7mVwsQAuw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"case.process_forcings() # You can turn off specific processing if it's already been processed previously with process_*name* = False. Ex. case.process_forcings(process_chl = False)","key":"v2VeyunEo5"},{"type":"outputs","id":"vIRCIdArb4mgOzOYupH-E","children":[],"key":"THKjZ9NTWh"}],"key":"xtcCV5OqH3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section 4: Build and run the case","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t96fyEBlI7"}],"identifier":"section-4-build-and-run-the-case","label":"Section 4: Build and run the case","html_id":"section-4-build-and-run-the-case","implicit":true,"key":"xWgM2e4Y6W"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After completing the previous steps, you are ready to build and run your CESM case. Begin by navigating to the case root directory specified during the case creation. Before proceeding, review the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o8MZTqrgBH"},{"type":"inlineCode","value":"user_nl_mom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rmcqxavYM7"},{"type":"text","value":" file located in the case directory. This file contains MOM6 parameter settings that were automatically generated by CrocoDash. Carefully examine these parameters and make any necessary adjustments to fine-tune the model for your specific requirements. While CrocoDash aims to provide a solid starting point, further tuning and adjustments are typically necessary to improve the model for your use case.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x4YaTkaWpl"}],"key":"M0r6vWNCBA"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Once you have reviewed and modified the parameters as needed, you can build and execute the case using the following commands:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u1Q3maTdOo"}],"key":"yx0wIrsCz9"},{"type":"code","lang":"","value":"qcmd -- ./case.build\n./case.submit","position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"key":"iYf5axXvZt"}],"key":"YkRHRPSfgl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Where to go from here?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BgmKNIyuHr"}],"identifier":"where-to-go-from-here","label":"Where to go from here?","html_id":"where-to-go-from-here","implicit":true,"key":"uWhnIzOqLU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This project covered the basics of CrocoDash. Feel free to modify it in any of the ways described above — for example, adding biogeochemistry (BGC), river forcing (DROF), or tides — to set up your own regional domain of interest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iszrd9tGo6"}],"key":"v8MILbycNJ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"More interested in exploring model output? Feel free to check out the CUPiD or CARIB12 projects, which go over basic and advanced diagnostics (respectively) of regional MOM6 simulations. There’s also a 10-month dataset for a northwest Atlantic domain used by CUPiD that’s available for analysis.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zEnLzCvdFy"}],"key":"SyjTCP1tPZ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Interested in moving into advanced applications of regional modeling? We’d love your help! CrocoDash may not yet have all the features you need - so please work with us! We would love to have YOU as a contributor! Even if you don’t prefer to code, we would appreciate raising any feedback you have.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j64YnZLBgQ"}],"key":"bLl69p1Zoq"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Our philosphy is simple - Make the setup of regional domains as easy as possible (no matter the complexity), and take on as much of the software burden as we can. For now, that means:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XQYSJl8N15"}],"key":"obVeSwoInZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We want your feedback! contributions & issues are always welcome","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PsCaT34PLY"}],"key":"N3I5aQKwZe"}],"key":"pPHFwcMKvF"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CrocoDash is designed to be an easy framework to dive into the coding aspects (Want to modify boundary conditions? Adjust how the cholorphyll file is generated?) You can easily plug into this framework and modify the tools you need for your regional domain.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Fcp2ZUpWEl"}],"key":"Zf0CIotreq"}],"key":"oC6XESIufU"}],"key":"xiGbNwArIn"}],"key":"ryZ6rlMRgb"}],"key":"vUcwYZ8lxU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Add Boundary Tides to the Run","url":"/notebooks/features/add-tides","group":"Additional Component Tutorials"},"next":{"title":"BGC Sample Project","url":"/notebooks/projects/sample-crocodash-projects/bgc","group":"Sample CrocoDash Projects"}}},"domain":"http://localhost:3000"}